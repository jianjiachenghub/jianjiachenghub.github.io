<hr>
<p>title: react组件间的信息交流<br>date: 2019-06-30 13:05:50<br>tags:</p>
<ul>
<li>React </li>
<li>Javascript<br>categories: </li>
<li>Javascript</li>
<li>React</li>
</ul>
<hr>
<blockquote>
<p>React 组件之间交流的方式，可以分为以下 3 种：<br>a【父组件】向【子组件】传值；<br>b【子组件】向【父组件】传值；<br>c 没有任何嵌套关系的组件之间传值（PS：比如：兄弟组件之间传值）</p>
</blockquote>
<h3 id="1-父组件向子组件传递信息"><a href="#1-父组件向子组件传递信息" class="headerlink" title="1.父组件向子组件传递信息"></a>1.父组件向子组件传递信息</h3><p><strong>这个比较容易和直观</strong></p>
<pre><code>// 父组件
var MyContainer = React.createClass({
  getInitialState: function () {
    return {
      checked: true
    };
  },
  render: function() {
    return (
      &lt;ToggleButton text=&quot;Toggle me&quot; checked={this.state.checked} /&gt;
    );
  }
});

// 子组件
var ToggleButton = React.createClass({
  render: function () {
    // 从【父组件】获取的值
    var checked = this.props.checked,
        text = this.props.text;

    return (
        &lt;label&gt;{text}: &lt;input type=&quot;checkbox&quot; checked={checked} /&gt;&lt;/label&gt;
    );
  }
});</code></pre><p><img src="1.png" alt="图片描述"></p>
<h3 id="2子组件向父组件传递信息"><a href="#2子组件向父组件传递信息" class="headerlink" title="2子组件向父组件传递信息"></a>2子组件向父组件传递信息</h3><p><strong>子组件需要控制自己的 state， 然后告诉父组件自己的state，通过props调用父组件中用来控制state的函数，在父组件中展示子组件的state变化。</strong></p>
<pre><code>//子组件
var Child = React.createClass({
    render: function(){
        return (
            &lt;div&gt;
                请输入邮箱：&lt;input onChange={this.props.handleEmail}/&gt;
            &lt;/div&gt;
        )
    }
});
//父组件，此处通过event.target.value获取子组件的值
var Parent = React.createClass({
    getInitialState: function(){
        return {
            email: &apos;&apos;
        }
    },
    handleEmail: function(event){
        this.setState({email: event.target.value});
    },
    render: function(){
        return (
            &lt;div&gt;
                &lt;div&gt;用户邮箱：{this.state.email}&lt;/div&gt;
                &lt;Child name=&quot;email&quot; handleEmail={this.handleEmail.bind(this)}/&gt;
            &lt;/div&gt;
        )
    }
});
React.render(
  &lt;Parent /&gt;,
  document.getElementById(&apos;test&apos;)
);</code></pre><p><img src="1.png" alt="图片描述"></p>
<h3 id="3-兄弟组件传递信息"><a href="#3-兄弟组件传递信息" class="headerlink" title="3.兄弟组件传递信息"></a>3.兄弟组件传递信息</h3><blockquote>
<p>我们可以通过给这两兄弟一个共同的父亲，然后结合上面的两种方法<br>将老大的信息传给父亲（子传父），再通过父亲传给老二信息实现交流（父传子）</p>
</blockquote>
<p><strong>这里只写出了父组件代码实现input到list的数据传递</strong></p>
<pre><code>class CommentApp extends Component {
    constructor() {
        super()
        this.state = {
            arry: []
        }
    }
    getDate(obj) {
        this.state.arry.push(obj)
        this.setState({
            arry: this.state.arry
        })
        console.log(this.state.arry)
    }
    render() {
        return (
            &lt;div&gt;
                &lt;CommentInput date={this.getDate.bind(this)}/&gt;
                &lt;CommentList arry={this.state.arry}/&gt;
            &lt;/div&gt;
        )
    }
}
</code></pre>